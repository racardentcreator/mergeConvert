function onOpen() {
  createReport()
  const ui = SpreadsheetApp.getUi();
  const menu = ui.createMenu('Aish Gupta');
  menu.addItem('docpopulator', 'createReport')
  menu.addToUi();
}

function copyScriptFromSampleDoc(body) {
  const paras =  DocumentApp.openById('1NSwOYBuqsCZtArQ6s563NVG1HFK93OSu6AO9qRsEHSg').getBody().getParagraphs();
  for (i in paras) {
    Logger.log(paras[i].getText());
    body.appendParagraph(paras[i].copy())
  }
  return body;
}

function attachImage(body,id) {
  var image = DriveApp.getFileById(id).getBlob();
  //var paragraph = body.appendParagraph("\n");
  // Add the PositionedImage with offsets (in points).
  //var posImage = paragraph.addPositionedImage(image);
  var img = body.appendImage(image)
  const width = 300*img.getWidth()/img.getHeight();
  img.setWidth(width).setHeight(300);
}

function replaceTagsWithCells(body) {
  body.replaceText('{{Project Title}}','Adbhut')
  body.replaceText('{{Club Name}}','Rotaract E-Club of Ardent Creators')
  body.replaceText('{{Focus Area Covered}}','Environment')
  body.replaceText('{{Audience Targeted}}','Students')
}


function createReport() {
  const doc = DocumentApp.create('testDoc');
  const body = doc.getBody();
  doc.addHeader().insertImage(0,DriveApp.getFileById('1E10wZBkWwHyjQxmaE18WQj_iiTGdR_af').getBlob())
  //Logger.log(body.getText())
  copyScriptFromSampleDoc(body);

  replaceTagsWithCells(body);

  attachImage(body,'1GORZPwbTcoTg24941_fX83BFMjFBjoJK')
  attachImage(body,'1QSFE4CmX8OVTDnGk2QfFYmac3qKL6J7q')
  attachImage(body,'1arhVh9dH4zrs4x-j_HkBC4meM9WaAEU_')

  body.appendPageBreak();
  copyScriptFromSampleDoc(body);
  Logger.log(body.getText())


  //var toCopyText = 
  //view?usp=sharing
  //var text = body.editAsText();
  //var toAppendText = getTextFromSample();
  //text.appendText(toAppendText);
  //body.appendPageBreak();
  //text.appendText(toAppendText);
  //doc.saveAndClose()
}

/**function getIdFromUrl(url) { return url.match(/[-\w]{27,}/); }
 
function createNewGoogleDocs() {
 
 // Parent folder for all application
 //const applicationsFolder = DriveApp.getFolderById('1svlwyZsS4039Vhqmqgryh3yXQsmUVlEVy1i33QCGgvpaLMz3QpqPU60YDjwgjJBp_KAOoEPF');
 
 const destinationFolder = DriveApp.getFolderById('1YzV3gKdaCOqSKe3DnQPDwHzs2s6F-i_FmTaXICSnAWLInSWyVwA1uuywOjaI5cUH4pEZhCLD')
 
   //Here we store the sheet as a variable
 const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheets()[0];
  //Now we get all of the values as a 2D array
 const rows = sheet.getDataRange().getValues();
  //Start processing each spreadsheet row
 rows.forEach(function(row, index){
   //Here we check if this row is the headers, if so we skip it
   if (index === 0) return;

   var folderIteratorChecker = destinationFolder.getFoldersByName('day ' + row[0].toString()[9]);
   var dateFolder;
   //we check if the club already exists
   if (folderIteratorChecker.hasNext()) {
     dateFolder = folderIteratorChecker.next();
   }else {
     dateFolder = destinationFolder.createFolder('day ' + row[0].toString()[9]);
   }

   //Here we check if a document has already been generated by looking at 'Document Link', if so we skip it
   if (!row[8]) return;
 
   folderIteratorChecker = dateFolder.getFoldersByName(row[1]);
   var applicantFolder;
   //we check if the club already exists
   if (folderIteratorChecker.hasNext()) {
     applicantFolder = folderIteratorChecker.next();
   }else {
     applicantFolder = dateFolder.createFolder(row[1]);
   }
 
   //photo row break apart
   const photos = row[8].toString().split(', ');
   const noOfPhotos = photos.length
   //movement process
   for(var counter = 0; counter < noOfPhotos; counter = counter + 1) {
    try {
      DriveApp.getFileById(
        getIdFromUrl(
          photos[counter]
        )
      ).moveTo(applicantFolder);
    } catch {
      Logger.log(row[0].toString()[9] + row[1]);
    }
    }
   //copy process
 })
 
}**/
